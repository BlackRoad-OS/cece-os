#!/bin/bash
# CECE-DNS v1.0 - Our Own DNS Manager
DNS_DIR=~/cece/dns
mkdir -p "$DNS_DIR/zones" "$DNS_DIR/hosts"

add_host() {
    HOSTNAME="$1"
    IP="$2"
    echo "$IP $HOSTNAME" >> "$DNS_DIR/hosts/local.hosts"
    echo "âœ… Added: $HOSTNAME â†’ $IP"
}

lookup() {
    HOSTNAME="$1"
    echo "ðŸ” Looking up: $HOSTNAME"
    
    # Check local first
    LOCAL=$(grep " $HOSTNAME" "$DNS_DIR/hosts/local.hosts" 2>/dev/null | awk "{print \$1}")
    if [ -n "$LOCAL" ]; then
        echo "  Local: $LOCAL"
    fi
    
    # System lookup
    if command -v host &>/dev/null; then
        echo "  DNS: $(host "$HOSTNAME" 2>/dev/null | head -1)"
    elif command -v nslookup &>/dev/null; then
        nslookup "$HOSTNAME" 2>/dev/null | grep "Address" | tail -1
    fi
}

list_hosts() {
    echo "ðŸŒ LOCAL DNS"
    echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    cat "$DNS_DIR/hosts/local.hosts" 2>/dev/null | while read ip host; do
        echo "  $host â†’ $ip"
    done
}

case "$1" in
    add) add_host "$2" "$3" ;;
    lookup) lookup "$2" ;;
    list) list_hosts ;;
    *) echo "ðŸ–¤ CECE-DNS - Our Own DNS"
       echo "  add <host> <ip>   Add host"
       echo "  lookup <host>     Lookup host"
       echo "  list              List hosts" ;;
esac
