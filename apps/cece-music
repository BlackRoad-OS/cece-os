#!/bin/bash
# CECE-MUSIC v1.0 - Our Own Spotify
MUSIC_DIR=~/cece/music
mkdir -p "$MUSIC_DIR/playlists" "$MUSIC_DIR/library"

create_playlist() {
    NAME="$1"
    PLAYLIST="$MUSIC_DIR/playlists/$NAME.m3u"
    echo "# $NAME Playlist" > "$PLAYLIST"
    echo "# Created: $(date)" >> "$PLAYLIST"
    echo "âœ… Playlist created: $NAME"
}

add_song() {
    PLAYLIST="$1"
    SONG="$2"
    ARTIST="$3"
    echo "$ARTIST - $SONG" >> "$MUSIC_DIR/playlists/$PLAYLIST.m3u"
    echo "âœ… Added: $ARTIST - $SONG to $PLAYLIST"
}

play_playlist() {
    PLAYLIST="$1"
    PLAYLIST_FILE="$MUSIC_DIR/playlists/$PLAYLIST.m3u"
    [ ! -f "$PLAYLIST_FILE" ] && echo "Playlist not found" && return
    
    echo "â–¶ï¸  NOW PLAYING: $PLAYLIST"
    echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
    echo ""
    grep -v "^#" "$PLAYLIST_FILE" | while read -r song; do
        echo "  ðŸŽµ $song"
    done
    echo ""
    echo "  â®ï¸  â¸ï¸  â­ï¸   ðŸ”€  ðŸ”"
}

list_playlists() {
    echo "ðŸŽµ PLAYLISTS"
    for p in "$MUSIC_DIR/playlists"/*.m3u 2>/dev/null; do
        [ -f "$p" ] || continue
        NAME=$(basename "$p" .m3u)
        COUNT=$(grep -v "^#" "$p" | wc -l)
        echo "  ðŸŽ¶ $NAME ($COUNT songs)"
    done
}

case "$1" in
    new) create_playlist "$2" ;;
    add) add_song "$2" "$3" "$4" ;;
    play) play_playlist "$2" ;;
    list) list_playlists ;;
    *) echo "ðŸ–¤ CECE-MUSIC - Our Own Spotify"
       echo "  new <name>                    Create playlist"
       echo "  add <playlist> <song> <artist> Add song"
       echo "  play <playlist>               Play playlist"
       echo "  list                          List playlists" ;;
esac
