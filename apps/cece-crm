#!/bin/bash
# CECE-CRM v1.0 - Our Own Salesforce
CRM=~/cece/crm

add_contact() {
    echo -n "Name: "; read NAME
    echo -n "Email: "; read EMAIL
    echo -n "Company: "; read COMPANY
    ID=$(date +%s)
    echo "name:$NAME|email:$EMAIL|company:$COMPANY|created:$(date)" > "$CRM/contacts/$ID.contact"
    echo "âœ… Contact added: $NAME"
}

list_contacts() {
    echo "ðŸ“‡ Contacts:"
    for f in "$CRM/contacts"/*.contact; do
        [ -f "$f" ] || continue
        NAME=$(grep -o "name:[^|]*" "$f" | cut -d: -f2)
        COMPANY=$(grep -o "company:[^|]*" "$f" | cut -d: -f2)
        echo "  â€¢ $NAME ($COMPANY)"
    done
}

add_deal() {
    echo -n "Deal name: "; read NAME
    echo -n "Value: "; read VALUE
    echo -n "Stage (lead/qualified/proposal/closed): "; read STAGE
    ID=$(date +%s)
    echo "name:$NAME|value:$VALUE|stage:$STAGE|created:$(date)" > "$CRM/deals/$ID.deal"
    echo "âœ… Deal added: $NAME ($VALUE)"
}

pipeline() {
    echo "ðŸ’° Sales Pipeline:"
    TOTAL=0
    for f in "$CRM/deals"/*.deal; do
        [ -f "$f" ] || continue
        NAME=$(grep -o "name:[^|]*" "$f" | cut -d: -f2)
        VALUE=$(grep -o "value:[^|]*" "$f" | cut -d: -f2)
        STAGE=$(grep -o "stage:[^|]*" "$f" | cut -d: -f2)
        echo "  [$STAGE] $NAME - \$$VALUE"
        TOTAL=$((TOTAL + VALUE))
    done
    echo "  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
    echo "  Total: \$$TOTAL"
}

case "$1" in
    contact|c) add_contact ;;
    contacts|list) list_contacts ;;
    deal|d) add_deal ;;
    pipeline|p) pipeline ;;
    *)
        echo "CECE-CRM - Our Own Salesforce"
        echo "  contact   - Add contact"
        echo "  contacts  - List contacts"
        echo "  deal      - Add deal"
        echo "  pipeline  - View pipeline"
        ;;
esac
